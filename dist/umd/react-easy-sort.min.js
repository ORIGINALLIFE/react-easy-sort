!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("tslib"),require("react")):"function"==typeof define&&define.amd?define(["exports","tslib","react"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ReactEasySort={},e.tslib,e.React)}(this,(function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var u=r(n),o=function(e,t,n){for(var r=e.x,u=e.y,o=(void 0===n?{}:n).fallbackToClosest,c=void 0!==o&&o,a=1e4,i=-1,l=0;l<t.length;l+=1){var f=t[l];if(r>=f.left&&r<f.right&&u>=f.top&&u<f.bottom)return l;if(c){var d=(f.left+f.right)/2,s=(f.top+f.bottom)/2,v=Math.sqrt(Math.pow(r-d,2)+Math.pow(u-s,2));v<a&&(a=v,i=l)}}return i},c=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},a=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},i=function(e,t){return{x:e.x-t.x,y:e.y-t.y}},l=function(e){e.preventDefault()},f=function(){window.removeEventListener("contextmenu",l)},d=function(e){var t=e.onStart,n=e.onMove,r=e.onEnd,o=e.containerRef,d=e.knobs,s=u.default.useRef({x:0,y:0}),v=u.default.useRef(void 0),m=u.default.useRef(!1),p=u.default.useRef({onStart:t,onMove:n,onEnd:r}),b=u.default.useState(!1),h=b[0],E=b[1];u.default.useEffect((function(){p.current={onStart:t,onMove:n,onEnd:r}}),[t,n,r]);var y=function(){v.current&&window.clearTimeout(v.current)},g=u.default.useCallback((function(){if(o.current){var e=o.current.getBoundingClientRect();s.current={x:e.left,y:e.top}}}),[o]),x=u.default.useCallback((function(e){var t=i(e,s.current);p.current.onMove&&p.current.onMove({pointInWindow:e,point:t})}),[]),C=u.default.useCallback((function(e){if(m.current){m.current=!1;var t=c(e),n=i(t,s.current);p.current.onStart&&p.current.onStart({point:n,pointInWindow:t})}else x(c(e))}),[x]),w=u.default.useCallback((function(e){e.cancelable?(e.preventDefault(),x(a(e.touches[0]))):(document.removeEventListener("touchmove",w),p.current.onEnd&&p.current.onEnd())}),[x]),L=u.default.useCallback((function(){m.current=!1,document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",L),p.current.onEnd&&p.current.onEnd()}),[C]),R=u.default.useCallback((function(){document.removeEventListener("touchmove",w),document.removeEventListener("touchend",R),f(),p.current.onEnd&&p.current.onEnd()}),[w]),k=u.default.useCallback((function(e){0===e.button&&((null==d?void 0:d.length)&&!d.find((function(t){return t.contains(e.target)}))||(document.addEventListener("mousemove",C),document.addEventListener("mouseup",L),g(),m.current=!0))}),[C,L,g,d]),S=u.default.useCallback((function(e,t){document.addEventListener("touchmove",w,{capture:!1,passive:!1}),document.addEventListener("touchend",R),window.addEventListener("contextmenu",l,{capture:!0,passive:!1}),p.current.onStart&&p.current.onStart({point:e,pointInWindow:t})}),[R,w]),I=u.default.useCallback((function(e){if(!(null==d?void 0:d.length)||d.find((function(t){return t.contains(e.target)}))){g();var t=a(e.touches[0]),n=i(t,s.current);v.current=window.setTimeout((function(){return S(n,t)}),120)}}),[S,g,d]),M=u.default.useCallback((function(){E(!0),document.removeEventListener("touchstart",M)}),[]),_=u.default.useCallback((function(){y()}),[]);return u.default.useLayoutEffect((function(){if(h){var e=o.current;return null==e||e.addEventListener("touchstart",I,{capture:!0,passive:!1}),document.addEventListener("touchmove",_,{capture:!1,passive:!1}),document.addEventListener("touchend",_,{capture:!1,passive:!1}),function(){null==e||e.removeEventListener("touchstart",I),document.removeEventListener("touchmove",_),document.removeEventListener("touchend",_),document.removeEventListener("touchmove",w),document.removeEventListener("touchend",R),f(),y()}}return document.addEventListener("touchstart",M),function(){document.removeEventListener("touchstart",M),document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",L)}}),[h,M,C,w,_,R,L,o,I]),h?{}:{onMouseDown:k}},s=u.default.createContext(void 0);e.SortableItem=function(e){var t=e.children,n=u.default.useContext(s);if(!n)throw new Error("SortableItem must be a child of SortableList");var r=n.registerItem,o=n.removeItem,c=u.default.useRef(null);return u.default.useEffect((function(){var e=c.current;return e&&r(e),function(){e&&o(e)}}),[r,o,t]),u.default.cloneElement(t,{ref:c})},e.SortableKnob=function(e){var t=e.children,n=u.default.useContext(s);if(!n)throw new Error("SortableKnob must be a child of SortableList");var r=n.registerKnob,o=n.removeKnob,c=u.default.useRef(null);return u.default.useEffect((function(){var e=c.current;return e&&r(e),function(){e&&o(e)}}),[r,o,t]),u.default.cloneElement(t,{ref:c})},e.default=function(e){var n=e.children,r=e.allowDrag,c=void 0===r||r,a=e.onSortEnd,i=e.draggedItemClassName,l=e.as,f=t.__rest(e,["children","allowDrag","onSortEnd","draggedItemClassName","as"]),v=u.default.useRef([]),m=u.default.useRef([]),p=u.default.useRef([]),b=u.default.useRef(null),h=u.default.useRef(null),E=u.default.useRef(void 0),y=u.default.useRef(void 0),g=u.default.useRef({x:0,y:0});u.default.useEffect((function(){return function(){h.current&&document.body.removeChild(h.current)}}),[]);var x=function(e){if(h.current){var t=g.current;h.current.style.transform="translate3d("+(e.x-t.x)+"px, "+(e.y-t.y)+"px, 0px)"}},C=u.default.useCallback((function(e){if(b.current){var t=v.current[e],n=m.current[e],r=t.cloneNode(!0);i&&i.split(" ").forEach((function(e){return r.classList.add(e)})),r.style.width=n.width+"px",r.style.height=n.height+"px",r.style.position="fixed",r.style.margin="0",r.style.top="0",r.style.left="0",document.body.appendChild(r),h.current=r}}),[i]),w=d({containerRef:b,knobs:p.current,onStart:function(e){var t=e.pointInWindow;if(b.current){m.current=v.current.map((function(e){return e.getBoundingClientRect()}));var n=o(t,m.current);if(-1!==n){E.current=n,C(n);var r=v.current[n];r.style.opacity="0",r.style.visibility="hidden";var u=r.getBoundingClientRect();g.current={x:t.x-u.left,y:t.y-u.top},x(t),window.navigator.vibrate&&window.navigator.vibrate(100)}}},onMove:function(e){var t=e.pointInWindow;x(t);var n=E.current;if(void 0!==n){var r=o(t,m.current,{fallbackToClosest:!0});if(-1!==r){y.current=r;for(var u=n<r,c=0;c<v.current.length;c+=1){var a=v.current[c],i=m.current[c];if(u&&c>=n&&c<=r||!u&&c>=r&&c<=n){var l=m.current[u?c-1:c+1];if(l){var f=l.left-i.left,d=l.top-i.top;a.style.transform="translate3d("+f+"px, "+d+"px, 0px)"}}else a.style.transform="translate3d(0,0,0)";a.style.transitionDuration="300ms"}}}},onEnd:function(){for(var e=0;e<v.current.length;e+=1){var t=v.current[e];t.style.transform="",t.style.transitionDuration=""}var n,r,u,o=E.current;if(void 0!==o){var c=v.current[o];c&&(c.style.opacity="1",c.style.visibility="");var i=y.current;void 0!==i&&o!==i&&(v.current=(n=v.current,r=o,u=i,function(e,t,n){var r=t<0?e.length+t:t;if(r>=0&&r<e.length){var u=n<0?e.length+n:n,o=e.splice(t,1)[0];e.splice(u,0,o)}}(n=n.slice(),r,u),n),a(o,i))}E.current=void 0,y.current=void 0,h.current&&(document.body.removeChild(h.current),h.current=null)}}),L=u.default.useCallback((function(e){v.current.push(e)}),[]),R=u.default.useCallback((function(e){var t=v.current.indexOf(e);-1!==t&&v.current.splice(t,1)}),[]),k=u.default.useCallback((function(e){p.current.push(e)}),[]),S=u.default.useCallback((function(e){var t=p.current.indexOf(e);-1!==t&&p.current.splice(t,1)}),[]),I=u.default.useMemo((function(){return{registerItem:L,removeItem:R,registerKnob:k,removeKnob:S}}),[L,R,k,S]);return u.default.createElement(l||"div",t.__assign(t.__assign(t.__assign({},c?w:{}),f),{ref:b}),u.default.createElement(s.Provider,{value:I},n))},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=react-easy-sort.min.js.map
